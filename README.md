# Log Owl

Desktop‑приложение для трекинга времени и задач, построенное на Electron, React и TypeScript. Это pet‑project, в котором я **показываю продакшен‑подходы** (типобезопасный IPC, строгий линтинг, миграции БД, сборка через CI), но без претензии на идеальный продукт.

## Как попробовать

- **Самый простой способ**: скачать готовый установщик со страницы Releases этого репозитория (Windows / macOS / Linux).
- **Собрать локально desktop‑приложение**:
  - установите зависимости: `pnpm install`;
  - соберите установщик: `pnpm run build:desktop` (подробности — в `docs/BUILD.md`).
- **Запустить в dev‑режиме (для разработки)**:
  - `pnpm install`;
  - `pnpm run dev` — подробнее в `docs/DEV-SETUP.md`.

---

## Мотивация

Идея приложения родилась из реальной потребности: моей девушке нужен был удобный инструмент для логирования, который подстраивается под её рабочий флоу, а не наоборот.

Классический веб‑подход (frontend + backend) выглядел избыточным — особенно с учётом требования локального хранения. Комментарии могли касаться внутренних рабочих процессов, и поднимать API с удалённым хранилищем ради простого, но безопасного логирования означало бы усложнить архитектуру и отложить момент, когда приложением уже можно пользоваться.

В итоге я выбрал desktop‑формат и реализовал приложение на Electron. Это позволило:

- хранить данные полностью локально;
- остаться на привычном стеке (React + TypeScript);
- заодно попробовать себя в desktop‑разработке.

Проект начался как решение конкретной задачи и вырос в хороший повод расширить технический горизонт.

---

## Основные возможности

- **Трекинг времени** по задачам/проектам (локально, без сервера).
- **Хранение данных в SQLite** через `better-sqlite3`.
- **Стабильный IPC‑контракт** между main и renderer:
  - Zod‑схемы и общий пакет `contracts` для описания формата сообщений.
  - Обёртки над IPC‑хендлерами с валидацией (`validateAndHandle`) и единым форматом ответов.
- **Современный стек для UI**:
  - React 18 + React Router.
  - MUI + Emotion для стилизации.
  - Zustand для состояния на клиенте.
- **Сборка desktop‑приложения**:
  - Electron + Vite для фронта.
  - `electron-builder` для упаковки под Windows / macOS / Linux.

> Часть фич и UX может быть упрощена — приоритет у демонстрации архитектурных и инфраструктурных приёмов.

---

## Технологический стек

- **Платформа и рантайм**
  - **Electron** — main‑процесс, управление окнами, доступ к файловой системе и БД.
  - **Node.js + TypeScript** — общий язык для main/renderer/скриптов.
  - **Vite + React** — dev‑сервер и сборщик для renderer, HMR и быстрые билды.
  - **React Router** — маршрутизация в renderer.
  - **Zustand** — управление состоянием на клиенте.

- **UI и стили**
  - **MUI (`@mui/material`, `@mui/icons-material`)** — дизайн‑система и готовые компоненты.
  - **Emotion (`@emotion/react`, `@emotion/styled`)** — CSS‑in‑JS и темизация.

- **Данные и доменная логика**
  - **SQLite + `better-sqlite3`** — локальная БД, миграции в `main/migrations`.
  - **Zod** — валидация данных и описание контрактов между слоями (общий пакет `contracts`).
  - **Day.js** — работа с датами и временем.

- **Инфраструктура desktop‑сборки**
  - **`electron-builder`** — упаковка под Windows / macOS / Linux.
  - **`electron-rebuild`** — пересборка нативных модулей (например, `better-sqlite3`).
  - **`wait-on`, `concurrently`** — оркестрация дев‑скриптов main + renderer.
  - **TypeScript compiler + `tsc-alias`** — сборка и поддержка path‑alias’ов для main‑части.

- **Качество кода и проверки**
  - **ESLint** (+ `@eslint/js`, `typescript-eslint`, плагины для React/импортов/сортировки) — статический анализ.
  - **Prettier + eslint-config-prettier** — единое форматирование.
  - **Vitest** — юнит‑тесты.
  - **CSpell + `cspell-dict-ru_ru`** — проверка орфографии, включая русский.
  - **Husky + lint-staged** — pre‑commit‑хуки и запуск проверок перед коммитом.

---

## Быстрый старт для разработки

Подробная информация — в `docs/DEV-SETUP.md`. Ниже короткая версия.

### Требования

- Node.js 20+
- pnpm (используется `packageManager: pnpm@10.30.1`)

### Установка

```bash
pnpm install
```

### Запуск в режиме разработки

```bash
pnpm run dev
```

Это:

- собирает main‑часть (Electron);
- запускает Vite‑dev‑сервер для renderer;
- ждёт, пока фронтенд поднимется, и стартует Electron, указывая на локальный сервер.

Полезные альтернативы:

- только фронтенд: `pnpm run dev:vite`
- только Electron (предполагая запущенный Vite): `pnpm run dev:electron`

### Проверки качества

```bash
pnpm run check
```

Выполняет:

- `pnpm run lint` — ESLint;
- `pnpm run format:check` — проверка форматирования Prettier;
- `pnpm run spellcheck` — CSpell;
- `pnpm run test` — Vitest.

Хук pre-commit через Husky запускает `lint-staged` и `pnpm run test`, поэтому большинство проблем ловится до пуша.

---

## Сборка и релизы

### Локальная сборка desktop‑приложения

Подробное руководство по сборке установщиков для разных платформ — в `docs/BUILD.md`.
Это основной документ, если вам нужно **собрать и отдать установщик**.

Кратко, базовая команда:

```bash
pnpm run build:desktop
```

### CI и автоматические релизы

В репозитории настроен GitHub Actions:

- **`ci.yml`** — проверяет проект (`pnpm run check`) на pull request и push в основную ветку.
- **`release.yml`** — собирает установщики для Windows/macOS/Linux и выкладывает их в GitHub Releases при пуше тега вида `v*.*.*`.

Базовый сценарий релиза:

```bash
git tag v0.1.0
git push origin v0.1.0
```

После этого GitHub Actions соберёт артефакты и прикрепит их к релизу с этим тегом — пользователи смогут скачать готовые установщики.

---

## Архитектура проекта

Высокоуровневый обзор:

- **`main/`** — код Electron main‑процесса:
  - инициализация приложения и окон;
  - работа с БД и миграциями;
  - IPC‑каналы для общения с renderer;
  - инфраструктурные утилиты (логирование, error‑handling).
- **`renderer/`** — React‑приложение:
  - страницы и маршруты;
  - общие UI‑компоненты (MUI‑базис + свои обёртки);
  - хранилища Zustand;
  - клиент для обращения к IPC‑методам через типизированные контракты.
- **`contracts/`** — общие типы и контракты IPC между main и renderer.
- **`scripts/`** — вспомогательные скрипты (например, генерация каналов preload).
- **`docs/`** — документация (`DEV-SETUP.md`, `ARCHITECTURE.md`, `BUILD.md`, `BACKLOG.md`).

Основные принципы:

- разделение ответственности между main и renderer;
- строгая типизация и валидация на границах слоёв;
- минимум «магии» в конфигурации — всё завязано на понятные скрипты `package.json`.

---

## Документация для разработчиков

Если вы:

- хотите **развернуть проект и заняться разработкой** — читайте `docs/DEV-SETUP.md`;
- хотите разобраться в **архитектуре и технических решениях** (IPC, миграции БД, слои) — читайте `docs/ARCHITECTURE.md`;
- хотите **собрать установщики для разных платформ** — читайте `docs/BUILD.md`;
- хотите посмотреть **бэклог и идеи развития** — читайте `docs/BACKLOG.md`.

---

## Ограничения и дисклеймер

- Это **pet‑project**:
  - возможны недочёты и технический долг;
  - не все сценарии и edge‑кейсы закрыты.
- При этом я сознательно вкладываю сюда практики, которые считаю полезными в продакшене:
  - типизация контрактов;
  - линтинг и форматирование;
  - миграции БД и отдельный `BUILD.md`;
  - CI для сборки релизов.

Если вы смотрите проект как пример, обращайте внимание прежде всего на **структуру, автотесты, конфигурирование и инфраструктуру**, а не на идеальность UI/UX.

---

## Лицензия

MIT.
